# ASCII MINIAPP — Files Map

Этот документ отвечает на вопрос:
"Где искать конкретную логику?"

---

# FRONTEND

## index.html
Отвечает за:
- структуру интерфейса
- кнопки режимов (photo / live / video)
- контейнеры предпросмотра
- overlay / loader элементы
- подключение ascii.js

Если кнопка не нажимается → смотреть тут.

---

## styles.css
Отвечает за:
- расположение блоков
- цвета
- визуальное состояние кнопок
- скрытие / отображение элементов
- адаптивность

Если UI “поехал” → смотреть тут.

---

## ascii.js (ГЛАВНЫЙ ФАЙЛ)

Самый большой файл проекта.
Содержит:

### 1. Состояние приложения
- текущий режим (live/photo/video)
- fps
- charset
- contrast / gamma
- прозрачность фона

### 2. Логику режимов
- запуск камеры
- обработка фото
- обработка видео
- рендер ASCII

### 3. Рендер движок
- преобразование изображения в символы
- выбор палитры
- генерация текста

### 4. Telegram WebApp API
- tg.expand()
- MainButton
- взаимодействие с Telegram UI

Если:
- не работает конвертация → ascii.js
- странное поведение режимов → ascii.js
- не запускается камера → ascii.js

⚠ Этот файл не переписывать целиком.
Править только конкретные участки.

---

# BACKEND

## backend/server.js

Отвечает за:
- обработку апдейтов Telegram
- webhook
- маршрутизацию команд
- связь WebApp ↔ bot
- вызовы store.js

Если:
- команда не отвечает
- webhook не работает
→ смотреть server.js

---

## backend/store.js

Самый критичный backend-файл.

Отвечает за:
- баланс пользователя
- списания
- начисления
- звёзды
- рефералку
- лимиты
- админ-команды

Если:
- баланс списывается неправильно
- начисления не работают
→ смотреть store.js

⚠ Изменения делать осторожно.
Всегда понимать текущую логику перед правками.

---

# STATIC

## assets/
- шрифты
- иконки
- статические ресурсы

Если иконка не отображается → проверить путь тут.

---

# СЕРВЕР

VPS: Timecloud  
Путь: `/opt/trip-bot`  
PM2: `ascii-uploader`  
Webhook: используется

---

# Быстрая диагностика

UI проблема → index.html / styles.css  
ASCII логика → ascii.js  
Баланс / списания → store.js  
Команды / webhook → server.js  
